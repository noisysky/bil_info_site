<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
     <title>Brain Image Library: Data Submission</title>
     <meta http-equiv="x-ua-compatible" content="ie=edge" />
	 <meta name="viewport" content="width=device-width, initial-scale=1.0" />

     <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,800" />
     <link rel='stylesheet' href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
     <link rel="stylesheet" href="/css/bootstrap.css" />
     <link rel="stylesheet" href="/css/styles.css" />
     <link rel="stylesheet" href="/my.css" />
     <script src="/js/jquery.min.js"></script>

</head>

<body class="bg">
    <div class="container">
        <p>&nbsp;</p>
    </div>
    <div class="container">
    <!--Navigation bar-->
    <div id="topmenu">
    </div>
    <script>
        $(function(){
          $("#topmenu").load("menu.html");
        });
    </script>
    <!--end of Navigation bar-->

    <div class="jumbotron pagejumbotron">


<H1>Data Submission</H1>
<H2>Overview</H2>
A data contributor portal has been created to enable laboratories to submit 
data to the Brain Image Library. The key processes to submit data are:
<ol>
<li><a href="#Setup">Set up your submission account:</a> Setting up your submission account only needs to be done once. </li>
<ol type="A">
<li><a href="#Portal">Create an XSEDE portal account:</a> An XSEDE portal account is required to submit data. 
</li>
<li><a href="#RequestDSP">Request access to the data submission portal:</a> 
You will receive an email message once access has been enabled.  Please 
allow 24 hours for access to be granted.
</li>
<li><a href="#SetPasswd">Set your initial password:</a> 
</li> 
</ol> 
<li><a href="#EnterDSP">Enter the data submission portal:</a> Using your username and password, log into the data submission portal.
</li> 
<li><a href="#CreateSubCollection">Create a submission collection:</a> A submission collection 
is a wrapper associating image data with metadata. 
</li>
<li><a href="#UploadImage">Upload image data:</a> Because this is the 
time-limiting step, we suggest this step be started before uploading 
metadata for the submission collection. 
</li>
<li><a href="#UploadMetadata">Upload metadata:</a>  Submission collection metadata can 
be uploaded through the portal in spreadsheet format.
</li>
<li><a href="#ValidateData">Validate data:</a>  Validate the data and 
correct any errors discovered. 
</li>
<li><a href="#ReviewSubmit">Review and Submit data:</a> Please correct 
all errors and check all warnings in the validation log prior to submission.
</li>
</ol>
<img src="assets/WebSubmitFlow.png" alt="Data Submission Workflow" 
height="90%" width="90%" />
<H2>Definitions</H2>
	    <p>The following terms in this document have specific context, as defined below:</p>
<p>
<dl>
	<dt>Dataset</dT>
	<dd>In the BIL context, a dataset is a stand-alone entry (e.g. an image-volume) 
	    with unique metadata. A dataset typically contains many 2d image files that are
	    assembled to form a more complex two or three dimensional volume. A each "level"
	    of data is considered a separate dataset. (e.g. The set of raw data and the same 
	    data aligned to a reference are considered two separate datasets.)</dd>
	<dt>Submission</dT>
	<dd>A submission is an ingestion wrapper that contains one or more related datasets
	    and associated metadata. Submissions will inherit project metadata (such as the 
	    NIH project that the data is associated with), thus all datasets within a 
	    submission must belong to the same project. A submission can contain a single or 
	    multiple datasets. In general, smaller submissions are recommended because all
	    datasets within a submission must pass the validation process for the datasets 
	    within the submission to be published.</dd>
	<dt>Project</dt>
	<dd>A way of grouping data to ensure that (1) people working with the data get 
	    gain appropriate access and credit for their contributions and (2) Data is linked to the 
	    proper funding sources. Datasets within a submission will inherit project metadata</dd>
	<dt>Publish</dT>
	<dd>The act of making a submission that has passed all validation checks publicly 
		available. <em>Data is not fully "submitted" to BIL, until it is published</em></dd>
</dl>
</p>
<H2>Submission Steps</H2>
<p><i>If you have problems with the steps below, do not hesitate to contact 
the <a href="contact.html">BIL Helpdesk</a> for assistance.</i></p>
<ol>
<li id="Setup"><b>Set up your submission account</b>
<ol type="A">

<li id="Portal"><b>Create an XSEDE portal Account</b>
<p>Follow <a href="XSEDEportal.html">these instructions</a> to create an XSEDE portal Account. </p>
</li>

<li id="RequestDSP"><b>Request access to the data submission portal</b>
<p>Send email to <i>bil-support@psc.edu</i> along with your XSEDE Portal
Account. You will receive an email message once access has been enabled.  
Please allow 24 hours for access to be granted.
</p>
</li>

<li id="SetPasswd"><b>Set your initial password:</b>
<p>Follow <a href="password.html">these instructions</a> to set your initial 
password.</p>
</li>
</ol>

<li id="EnterDSP"><b>Enter the data submission portal</b>
To enter the data submission portal, visit 
<a href="https://submit.brainimagelibrary.org/">submit.brainimagelibrary.org</a>. 
Enter your PSC username and password on this page. If you are having problems 
logging in, please contact the <a href="contact.html">BIL Helpdesk</a>. </p>
<p>
<img src="assets/SubmissionPortal/DataSubPortalLogin.PNG" alt="login-page" 
height="90%" width="90%" />
</p>
</li>
<ol type="A">
<li id="SetProject"><b>Define your projects (PIs and Data Managers Only)</b>
<p>
<span class="badge badge-warning">Users that do not have PI/Data manager permissions will not have access to 
	the functions described in this step. If you need access to these functions,<br /> have the PI send email
	to the BIL helpdesk with your BIL userid and name and request that you be granted this portal permission. 
	</span></p> 
	
	<p>The PI dashboard allows PIs and Data managers to define and manage projects that will be submitting 
	datasets to BIL.  This dashboard will allow the PI to add authorized users to the project and see the status
	of in-progress, unsuccessful, and successful submissions associated with the project, regardless of the 
	users that uploaded and submitted the data. </p>
	<img src="assets/SubmissionPortal/PI_Dash.PNG" alt="login-page" 
	     height="90%" width="90%" /> </p>
	<p>To enter (or edit) project information, Select the
	<span class="badge badge-secondary">Manage Projects</span> option. From this menu you can create a new project and 
		view both the personnel and submissions associated with each project. </p>
	<p> 
	To define a project select the <span class="badge badge-secondary">Create a New Project</span> button. 
	Enter the <em>Project Name</em> and the grant number associated with the project in the <em>Funded By:</em>
	field. If the project is a BICCN project, please be sure to tag the project appropriately and make
	sure that the Project Name field contains the project name assigned by BCDC.</p>
	
	<p>To add a user to the project (such as a data submitter) select the <span class="badge badge-secondary">View
	Personnel</span> link and add the user.
	</p>
	
	
	    
<li id="CreateSubCollection"><b>Create a submission</b>
<p>
<span class="badge badge-warning">There MUST be a project defined to create a BIL submission</span></p>
<p>
The next step in the submission process is to create a BIL submission. A submission is an ingestion wrapper 
	that contains one or more related datasets and associated metadata. Submissions will inherit project metadata (such as the NIH project that the data 
is associated with), thus all datasets within a submission must belong to the same project. </p>
<p>
A submission can contain a single or multiple datasets. In general, smaller submissions are recommended
because all datasets within a submission must pass the validation process for the datasets 
within the submission to be published. 
</p>
<p>
When created, each BIL submission will have a a unique 16-digit identifier associated with it (e.g. <em>6247417d691a4548</em>) and
a unique dropbox-like landing zone directory  
(e.g. <em>/bil/lz/user/6247417d691a4548</em>. 
This landing zone directory is where the datasets belonging to the 
submission must be transferred to for validation and ingestion processing. 
</p>
<p>To create a submission, select the <span class="badge badge-secondary">
Submission</span> sub-option of the <span class="badge badge-secondary">New</span> 
menu.</p>
<p>
<img src="assets/SubmissionPortal/NewSub.PNG" alt="New-Submission image" 
height="90%" width="90%" />
</p>

<p>Next, enter the required metadata associated with the submission collection (see 
image below). 
<p>
<img src="assets/SubmissionPortal/DataSubPortalNewSub.PNG" alt="New-Submission-full image" 
height="90%" width="90%" />
</p>
<p>select the <span class="badge badge-secondary">Save</span> button.</p>
Next, 
</li>

<li id="UploadMetadata"><b>Upload Descriptive Metadata</b>
</li>
<p>Metadata for each dataset within a submission collection can be uploaded through the 
submission portal in spreadsheet format at this time.  A template spreadsheet 
can be found on the submission portal by selecting the 
<span class="badge badge-secondary">
New Metadata</span> sub-option of the 
<span class="badge badge-secondary">New</span> 
menu:</p>
<p><span class="badge badge-warning">
	If you are NOT ready to upload metadata at this time, click cancel to exit the metadata step. 
	When you are ready to load your metadata, return to the portal and select the
	<span class="badge badge-secondary">New Metadata</span> sub-option of the 
        <span class="badge badge-secondary">New</span> menu.
	</span>
</p>
<p>
<img src="assets/SubmissionPortal/DataSubPortalNewMenu.PNG" alt="New-Descriptive-Metadata Menu image" 
height="90%" width="90%" />
</p>
<p>
<img src="assets/SubmissionPortal/DataSubPortalDescriptiveMetadata.PNG" alt="Descriptive-Metadata Image" 
height="90%" width="90%" />
</p>
<p>After a metadata spreadsheet is prepared, Select the submission collection it will 
be associated with. Then select the <span class="badge badge-info">
Upload Metadata</span> button to locate your metadata spreadsheet and 
upload it.
</p>
</li>

	<li id="UploadImage"><b>Upload image data</b>
<p>
The ingestion process currently supports native TIFF and JPEG 2000 image 
file formats and will soon support formats that are convertible to the 
OME-TIFF format via the 
bioformats tool. For more information on the bioformats tool see: <br />
<a href="https://docs.openmicroscopy.org/bio-formats/5.7.3/formats/index.html">
https://docs.openmicroscopy.org/bio-formats/5.7.3/formats/index.html</a>.
</p>

<p>As mentioned above in the prior step, the submission portal creates 
an upload landing zone space for image data. To find 
this landing zone, select the 
<span class="badge badge-secondary">
Collections</span> sub-option of the 
<span class="badge badge-dark">View</span> 
menu.</p>
<p>
<img src="assets/SubmissionPortal/DataSubPortalViewMenu.PNG" alt="View-Menu" 
height="90%" width="90%" />
</p>
<p>The landing zone is listed under the <span class="badge badge-info">Data 
Path</span> column:
</p>
<p>
<img src="assets/SubmissionPortal/DataSubViewCollections.PNG" alt="View-Collections" 
height="90%" width="90%" />
</p>
<p>To tie metadata to an image dataset, each image dataset must be uploaded 
in a separate subdirectory. For example, if you had an experiment containing 
5 mouse datasets that you wanted to to include as a single submission collection, you 
would create 5 subdirectories in the landing zone for the submission collection, one 
for each mouse dataset. e.g:</p>
/bil/lz/testuser/abcdef0123456789/mouse1<br />
/bil/lz/testuser/abcdef0123456789/mouse2<br />
/bil/lz/testuser/abcdef0123456789/mouse3<br />
/bil/lz/testuser/abcdef0123456789/mouse4<br />
/bil/lz/testuser/abcdef0123456789/mouse5<br />
</p>
<p>
<div class="card bg-warning">
<div class="card-body text-left">
<p class="card-text">
Due to size, 
image data can not be uploaded through the submission portal 
(submit.brainimagelibrary.org). 
It must be uploaded 
separately through the BIL data transfer nodes, which are available 
at the virtual host: upload.brainimagelibrary.org. All users authorized to 
use the data submission portal (submit.brainimagelibrary.org) are also 
authorized to use the data transfer nodes (upload.brainimagelibrary.org). 
The username and passwords are the same on both systems.
</p>
</div>
</div>
There are many supported ways to upload files into the landing zone 
directory through the BIL data transfer nodes including rsync, 
Globus, sftp, and scp. 
</p>
<ul>
<li>Using rsync to upload.brainimagelibrary.org: An example uploading 
all data in the directory 
(mouse1) as user <i>testuser</i> through the data transfer node 
upload.brainimagelibrary.org to the submission collection landing zone 
(abcdef0123456789)is shown below: 
<div class="card bg-light">
<div class="card-body text-left">
<p class="card-text">
<pre>
<code>
$ rsync -lrtpDvP mouse1 testuser@upload.brainimagelibrary.org:/bil/lz/testuser/abcdef0123456789
sending incremental file list
mouse1/
mouse1/data1.tiff
     1356122 100%  126.20MB/s    0:00:00 (xfer#1, to-check=0/2)

sent 1356392 bytes  received 35 bytes  2712854.00 bytes/sec
total size is 1356122  speedup is 1.00

</code>
</pre>
</p>
</div>
</div> 
</li>

<li>Using sftp to upload.brainimagelibrary.org: An example logging into 
the data transfer node as <i>testuser</i> is shown below. The first cd 
command is used to move to the BIL landing zone for the submission collection. 
The mkdir command is used to create a sub-directory (called <i>mouse1</i> 
in the landing zone, while the second cd command is used to move to this 
subdirectory.  Finally, the put command is used to upload data - in 
this case, a single file  (data1.tiff):
<div class="card bg-light">
<div class="card-body text-left">
<p class="card-text">
<pre>
<code>
$ sftp testuser@upload.brainimagelibrary.org
The authenticity of host 'upload.brainimagelibrary.org (128.182.108.164)' can't be established.
ECDSA key fingerprint is 32:cf:46:44:3d:9c:8e:b2:1d:14:03:66:45:0b:11:29.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added 'upload.brainimagelibrary.org,128.182.108.164' (ECDSA) to the list of known hosts.
testuser@upload.brainimagelibrary.org's password:
Connected to upload.brainimagelibrary.org.
sftp> cd /bil/lz/testuser/abcdef0123456789
sftp> mkdir /bil/lz/testuser/abcdef0123456789/mouse1
sftp> cd /bil/lz/testuser/abcdef0123456789/mouse1

sftp> put data1.tiff
Uploading data1.tiff to /bil/lz/testuser/abcdef0123456789/mouse1/data1.tiff
data1.tiff                                      0%    0     0.0KB/s   --:-- ETA
data1.tiff                                    100% 1324KB   1.3MB/s   00:00

sftp> exit
</code>
</pre>
</p>
</div>
</div> 
<p>
<span class="badge badge-warning">Due to their ability to resume interupted 
transfers, the use of rsync and Globus is recommended over sftp.</span></p> 
</li>

<li>Using scp to upload.brainimagelibrary.org: An example uploading data 
(data1.tiff) to the landing zone as <i>testuser</i> is shown below: 
<div class="card bg-light">
<div class="card-body text-left">
<p class="card-text">
<pre>
<code>
$ scp data1.tiff testuser@upload.brainimagelibrary.org:/bil/lz/abcdef0123456789/mouse1/data1.tiff
testuser@upload.brainimagelibrary.org's password:
data1.tiff                                                                      0%    0     0.0KB/s   --:-- ETA
data1.tiff                                                                    100% 1324KB   1.3MB/s   00:00

</code>
</pre>
</p>
</div>
</div> 
<p>
<span class="badge badge-warning">Due to their ability to resume interupted 
transfers, the use of rsync and Globus is recommended over scp.</span></p> 
</li>
</li>


</ul>

</li>





<!-- <li id="ValidateData"><b>Validate data</b>
-->
<li id="ValidateData"><b>Validate and Submit data</b>
Once all data has been uploaded to the landing zone area and all metadata 
has been uploaded to through the submission portal, request that the data is validated and made publically avaliable. 
This can be done through the submission portal by selecting "Submit validation request" from the "Submit" menu. 
If an embargo period is being requested, please send email to bil-support@psc.edu along with the submission collection
id. Please note that the dataset should be embargoed prior to public release, in the email message. 
 
<!--
<p>Once all data has been uploaded to the landing zone area and all metadata 
has been uploaded to through the submission portal, select the 
<span class="badge badge-secondary">
Validate Collection</span> sub-option of the 
<span class="badge badge-dark">Validate</span> menu:
</p>
<p>
<img src="assets/SubmissionPortal/DataSubPortalValidateMenu.PNG" alt="Validate-Collection-Menu Image" 
height="90%" width="90%" />
</p>
<p>
Next, choose the collection that you want to validate by selecting the <span class="badge badge-info">
Select</span> button.
</p>
<p>
<img src="assets/SubmissionPortal/DataSubViewCollections.PNG" alt="Validate-Collection-Choose Image" 
height="90%" width="90%" />
</p>
<p>Then select the <span class="badge badge-info">Validate</span> button. 
</p>
<img src="assets/SubmissionPortal/DataSubPortalValadateCollection.PNG" alt="Validate-Collection-Detail Image" 
height="90%" width="90%" />
</p>
The validation process is asyncronous. To check on the status, you may 
click on the <span class="badge badge-info">Validation Status</span> 
row in the screen shown above.   
The validation process will scrape additional metadata from the image
files. When the process completes, a log will be available for viewing 
by clicking on the <span class="badge badge-info">Validation Status</span>
row. Below is an example of 
a validation log for a collection that failed the validation process. 
(In this case, the problem was that image data was not uploaded for the 
collection.)
</p> 
<p>
<img src="assets/SubmissionPortal/DataSubPortalValidationDetail.PNG" alt="Validation-Additional-Detail Image" 
height="90%" width="90%" />
</p>

</li>


<li id="ReviewSubmit"><b>Review and submit data</b>

<p>When the validation process completes, 
a log will be accessable from the contributor portal. Please examine 
this log and correct any identified warnings and errors. (note: Only an 
error will prevent submission, a warning will not prevent data submission)     
</p>
<p>
<span class="badge badge-warning">Data submission through the portal has 
not been enabled yet.</span> 
</p>
-->

</li>
</ol>
<h2>Additional Submission Information</h2>

<p><b>Image File Formats</b></p>
<p>
To encourage maximal automatic metadata scraping, the library STRONGLY 
RECOMMENDS ORIGINAL FILES CAPTURED BY THE MICROSCOPE be submitted. 
</p>
<p>
The ingestion process supports native TIFF and JPEG 2000 image file formats 
and formats that are convertible to the OME-TIFF format via the 
bioformats tool. (For more information on the bioformats tool see: 
<a href="https://docs.openmicroscopy.org/bio-formats/5.7.3/formats/index.html">
https://docs.openmicroscopy.org/bio-formats/5.7.3/formats/index.html</a>.)
</p> 
<p><b>Metadata Formats and Schema</b></p>
<p>Please see the <a href="https://submit.brainimagelibrary.org/">Submission 
Portal</a> for the most recent metadata specification.
</p>
<p>The archive is transitioning to a new, more comprehensive metadata schema developed as a part of the NIH BRAIN Initiative "BRAIN 3D MICROSCOPY STANDARDS PROJECT". For more information about the standards project, please see the <a 
href="https://www.doryworkspace.org/">Dory website</a>.   A draft spreadsheet implementing this standard, which will soon be required by the ingest portal is available here. Collecting metadata on this more extensive form will also enable BIL to issue DOIs for datasets when data is submitted. 
<p>
<p><b>Pre-Submission Processing of Files:</b></p><p>
<p>
All data submitters are given access to a Cent-OS login node "login.brainimagelibrary.org". To connect to this node, use a terminal program that implements ssh (such as xterm, the native mac terminal program, or PuTTY) and use the same username and password that you would use for the submission portal. The login node is ideal for non-cpu intensive processing, such as editing or deleting a file that is already in the landing zone. 
</p>
If you need to perform more intensive processing on your data, such as QA/QC processing or if you need to share your data with others prior to submission, please see the section "Sharing data and computing on data prior to submission" below, then contact <a href="contact.html">BIL Helpdesk</a> for further assistance.
</p>
<!--
<p>By default, the files in the landing zone will only be accessible by you 
and BIL support staff. You can, of course, change the permissions on the 
landing zone to be group or world readable with chmod. This may help if you 
need to share the data with others (such as other lab group members) before 
completing the submission process. 
</p>
-->

<p><b>Assistance and Help</b></p>
<p>If you need assistance with anything, 
please contact the <a href="contact.html">BIL Helpdesk</a> for assistance.
Please note that we are located in the Eastern Time zone. </p> 
<p>
Please note that BIL also provides networking support. If you are 
experiencing networking issues related to data transfer (including 
slow transfer speeds), contact the <a href="contact.html">BIL Helpdesk</a>.
If network issues prevent data transfer, we may recommend that you send 
your datasets to us via an alternate path such on our BrainBall portable 
device or on LTO tape.  
</p>
<p><b>Distribution Licence</b></p>
Data submitted to the library will be redistributed to others under a 
Creative Commons Attribution-ShareAlike 4.0 International License. In 
addition, all data submitters expressly permit the Library data to be 
transferred to and maintained by another open data repository or by 
a government agency such as the US National Institutes of Health.
</p>
<p>
<b>Release of entries</b></p>
<p>
Data submitted to the library, by default,  will be released as soon 
as possible once data has completed the submission process. Optionally, 
data submitters can select a limited embargo period for their submitted 
data consistant with the data sharing policies of the BRAIN initiative and 
NIH data sharing policies, or up to one year if the data was not NIH funded. 
</p>
<p><b>Assignment of DOI</b></p>
BIL will soon issue permanent, citable DOI for submitted datasets, when the new metadata schema is implemented. BIL can also issue DOI's for groups of data so that they may be cited in a paper (<a href="https://doi.brainimagelibrary.org/doi/10.35077/g.19">See here for an example</a>).  
</p>
<p><b>Changes to entries after submission</b></p><p>
Changes may be made to submitted entries prior to release. Minor changes, 
such as updating metadata or adding citations may be made after dataset 
release. Major revisions will require the existing entry to be marked as 
obsolete and replaced by a new entry. The DOI pointing to the metadata for 
the obsolete entry may have a superseded-by field added to it to point
users to the superceded entry. There may be also be circumstances in which 
an entry in the library may be marked as withdrawn (for example, research 
misconduct). In those cases, the DOI for the obsolete entry will have a  
withdrawn field added to it.  
</p>
<p><b>Sharing and computing on data prior to submission</b></p><p>
There are several platforms that data submitters can use to share and compute on data prior to submission:
<ul>
	<li><a href="computevisual.html">BIL login node:</a> All users have access to the BIL login node (login.brainimagelibrary.org)
</li>
	<li><a href="computevisual.html">BIL VM System:</a> This system has a variety of memory and GPU configurations, has remote-desktop capability, 
	and can serve web portals. The VM system is ideal if you access to desktop software to visualize your data.  
</li>
<li><a href="computevisual.html">PSC's Bridges-2</a> computational resource is an excellent place to explore and share
	your data with others prior to submission. Since the /bil file system is available on Bridges-2, you will
	also have access to all public data released by the BRAIN Image Library.	
</li> 
	<li><a href="computevisual.html">PSC's Neocortex</a> is a highly innovative resource that will accelerate AI-powered scientific 
	    discovery by vastly shortening the time required for deep learning training and other AI approaches.
	</li>

</ul> 
</p>
<p><b>Use of Pre-publication Data</b></p><p>
The Library expects all users of the submitted data, unless explicitly granted by the data submitter or the data submitter's project, 
	to grant the authors of the data the right to publish the first paper concerning the dataset within three years of deposit. 
	If there is no publication associated with the dataset, please contact the listed authors for permission to publish. 
	There is no restriction on post-publication data.  
</p>

    </div>
    <!--Bottom Footer -->
    <div id="bottomfooter">
    </div>
    <script>
        $(function(){
          $("#bottomfooter").load("footer.html");
        });
    </script>
    <!--end of bottomfooter-->

    <script src="/js/jquery.min.js"></script>
    <script src="/js/popper.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
</div>
</body>
</html>
